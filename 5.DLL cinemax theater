#include <stdio.h>
#include <stdlib.h>

typedef struct Seat {
    int seatNo;
    int booked; // 0 = free, 1 = booked
    struct Seat *prev;
    struct Seat *next;
} Seat;

Seat *head = NULL;

void initializeSeats(int totalSeats) {
    Seat *temp, *newSeat;
    int i;
    for(i = 1; i <= totalSeats; i++) {
        newSeat = (Seat*)malloc(sizeof(Seat));
        newSeat->seatNo = i;
        newSeat->booked = 0; // free initially
        newSeat->next = NULL;
        newSeat->prev = temp;
        
        if(head == NULL) {
            head = newSeat;
        } else {
            temp->next = newSeat;
        }
        temp = newSeat;
    }
}

void displayAvailable() {
    Seat *temp = head;
    printf("Available seats: ");
    int found = 0;
    while(temp != NULL) {
        if(temp->booked == 0) {
            printf("%d ", temp->seatNo);
            found = 1;
        }
        temp = temp->next;
    }
    if(!found)
        printf("No seats available");
    printf("\n");
}

void bookSeat(int seatNo) {
    Seat *temp = head;
    while(temp != NULL && temp->seatNo != seatNo) {
        temp = temp->next;
    }
    if(temp == NULL) {
        printf("Seat number %d does not exist.\n", seatNo);
        return;
    }
    if(temp->booked == 1) {
        printf("Seat %d is already booked.\n", seatNo);
    } else {
        temp->booked = 1;
        printf("Seat %d booked successfully.\n", seatNo);
    }
}

void cancelBooking(int seatNo) {
    Seat *temp = head;
    while(temp != NULL && temp->seatNo != seatNo) {
        temp = temp->next;
    }
    if(temp == NULL) {
        printf("Seat number %d does not exist.\n", seatNo);
        return;
    }
    if(temp->booked == 0) {
        printf("Seat %d is not booked yet.\n", seatNo);
    } else {
        temp->booked = 0;
        printf("Booking for seat %d cancelled successfully.\n", seatNo);
    }
}

int main() {
    int totalSeats = 10, choice, seatNo;
    initializeSeats(totalSeats);

    while(1) {
        printf("\nMenu:\n1. Display Available Seats\n2. Book a Seat\n3. Cancel Booking\n4. Exit\nEnter choice: ");
        scanf("%d", &choice);

        switch(choice) {
            case 1:
                displayAvailable();
                break;
            case 2:
                printf("Enter seat number to book: ");
                scanf("%d", &seatNo);
                bookSeat(seatNo);
                break;
            case 3:
                printf("Enter seat number to cancel booking: ");
                scanf("%d", &seatNo);
                cancelBooking(seatNo);
                break;
            case 4:
                printf("Exiting program.\n");
                exit(0);
            default:
                printf("Invalid choice. Please try again.\n");
        }
    }
    return 0;
}


